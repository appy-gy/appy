// Generated by CoffeeScript 1.9.3
self.addEventListener('push', function(event) {
  return event.waitUntil(fetch('/api/private/browser_notifications', {
    credentials: 'include'
  }).then(function(response) {
    return response.json().then(function(arg) {
      var body, icon, notification, ref, tag, title, url;
      notification = arg.notification;
      ref = notification.payload, title = ref.title, body = ref.body, icon = ref.icon, tag = ref.tag, url = ref.url;
      return self.registration.showNotification(title, {
        body: body,
        icon: icon,
        tag: tag,
        data: {
          url: url
        }
      });
    });
  }));
});

self.addEventListener('notificationclick', function(event) {
  event.notification.close();
  if (clients.openWindow == null) {
    return;
  }
  return clients.openWindow(event.notification.data.url);
});
